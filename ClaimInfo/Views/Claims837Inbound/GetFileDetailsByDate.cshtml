@using ClaimInfo.Models
@using ClaimInfo.DataModel
@model IEnumerable<FileClaimDetails>
@{
    ViewBag.Title = "GetFileDetailsByDate";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
    int FileCount = ViewBag.FileCount;
}

<div class="rightpart">
    <div class="dashBx">
        <div class="clearfix"></div>
        <div class="dashformBx  dashformBx2 clearfix">
            <div class="dashfrm-L">
                <label class="lblTxt"> File Name </label>
                @Html.TextBox("fileName-filter", "", new { @class = "dashInp form-control input-filter", @search_index = "1" })
            </div>
            <div class="dashfrm-M">
                <label class="lblTxt">  File Status </label>
                @Html.TextBox("fileStatus-filter", "", new { @class = "dashInp form-control input-filter", @search_index = "2" })
            </div>
            <div class="dashfrm-M">
                <label class="lblTxt"> Submitter </label>
                @Html.TextBox("submitter-filter", "", new { @class = " dashInp form-control input-filter", @search_index = "12" })
            </div>
            <div class="dashfrm-R">
                <label class="lblTxt">  Reciever </label>
                @Html.TextBox("reciever-filter", "", new { @class = "dashInp form-control input-filter", @search_index = "13" })
            </div>
            <div class="clearfix"></div>
            <div class="dashfrm-L">
                <label class="lblTxt"> </label>
                <button class="editBtn pull-right filter-reset" style="width: 30%;"> Reset </button>
                @*<label class="lblTxt"> File Date From </label>
                    @Html.TextBox("startDate", "", new { @class = "dashInp date-filter form-control", @search_index = "3", @search_type = "from", @onkeydown = "return false;" })*@
            </div>
            <div class="dashfrm-M">
                @*<label class="lblTxt"> File Date To </label>
                    @Html.TextBox("endDate", "", new { @class = "dashInp date-filter form-control", @search_index = "3", @search_type = "to", @onkeydown = "return false;" })*@
            </div>
            <div class="dashfrm-M">

            </div>
            <div class="dashfrm-R">
            </div>
            <div class="clearfix"></div>
        </div>

        <table cellpadding="0" cellspacing="0" class="Grid">
            <tr>
                <th></th>
                <th>File Name</th>
                <th>File Date</th>
                <th>Submitter</th>
                <th>Receiver</th>
                <th>File Status</th>
            </tr>
            @foreach (FileClaimDetails fileIntake in Model)
            {
                <tr>
                    <td>
                        <img src="~/Images/plus.png" />
                        <div style="display:none">
                            <table cellpadding="0" cellspacing="0" id="ChildGrid" class="ChildGrid">
                                <tr>
                                    <th>Claim ID</th>
                                    <th>Claim Status</th>
                                    <th>Provider</th>
                                    <th>Claim Amount</th>
                                    <th>Error Code</th>
                                </tr>
                                @foreach (IntakeClaimData intakeClaim in fileIntake.IntakeClaimDataList)
                                {
                                    <tr>
                                        <td><a onclick="return check(@intakeClaim.SeqID)" style="color:#6AA2B8;" class="details" href="javascript:;">@intakeClaim.ClaimID</a></td>
                                        <td>@intakeClaim.ClaimStatus</td>
                                        <td>
                                            @intakeClaim.BillingProviderFirstName @intakeClaim.BillingProviderLastName
                                        </td>
                                        <td> <a onclick="return CallPartialView(@intakeClaim.SeqID)" style="color:#6AA2B8;" class="details" href="javascript:;">@intakeClaim.Claim_Amount</a></td>
                                        <td>@intakeClaim.ClaimLevelErrors</td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </td>
                    <td>@fileIntake.FileData.FileName</td>
                    <td>@fileIntake.FileData.FileDate</td>
                    <td>@fileIntake.FileData.Submitter_N103</td>
                    <td>@fileIntake.FileData.Receiver_N103</td>
                    <td>@fileIntake.FileStatus</td>
                </tr>
            }
        </table>
    </div>
    <div id="dialog" style="display:none;">
    </div>
    <div class="dashBx">
        <div id="PartialDivDashboard">
        </div>
    </div>
</div>

<script type="text/javascript">
    function CallPartialView(SeqID) {
        var name = SeqID;
        //alert(name);
        $.ajax({
            type: "POST",
            url: "/Claims/Details",
            data: '{SeqID: "' + name + '" }',
            contentType: "application/json; charset=utf-8",
            dataType: "html",
            success: function (response) {
                $('#PartialDivDashboard').html(response);
            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        });
    }

</script>
<style>
    .Grid {
        border: 1px solid #ccc;
        border-collapse: collapse;
        background-color: #fff;
    }

        .Grid th {
            background-color: #B8DBFD;
            color: #333;
            font-weight: bold;
        }

        .Grid th, .Grid td {
            padding: 5px;
            border: 1px solid #ccc;
        }

        .Grid img {
            cursor: pointer;
        }

    .ChildGrid {
        width: 100%;
    }

        .ChildGrid th {
            background-color: #6C6C6C;
            color: #fff;
            font-weight: bold;
        }
</style>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">
    //Assign Click event to Plus Image.
    $("body").on("click", "img[src*='plus.png']", function () {
        $(this).closest("tr").after("<tr><td></td><td colspan = '999'>" + $(this).next().html() + "</td></tr>");
        $(this).attr("src", "/images/minus.png");
    });
    //Assign Click event to Minus Image.
    $("body").on("click", "img[src*='minus.png']", function () {
        $(this).attr("src", "/images/plus.png");
        $(this).closest("tr").next().remove();
    });
</script>


@section js{
    <script type="text/javascript">
        $(".loadPartialView").click(function () {
            var name = $(this).attr('id');
            //alert(name);
            //var hr = $(this).attr("href");
            //alert(hr);
           // $('#PartialDivDashboard').load("@Url.Action("Details", "Claims", new { @sDate = 20190123 })");
            //$("#PartialDivDashboard").load("../Claims/ClaimCounts", new { sDate: name });
            $.ajax({
                type: "POST",
                url: "/Claims/ClaimCounts",
                data: '{sDate: "' + name + '" }',
                contentType: "application/json; charset=utf-8",
                dataType: "html",
                success: function (response) {
                    $('#PartialDivDashboard').html(response);
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
});
    </script>

    @*<script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/jquery-ui.js" type="text/javascript"></script>
        <link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/blitzer/jquery-ui.css"
              rel="stylesheet" type="text/css" />*@


    @*//Working*@
    <link href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/start/jquery-ui.min.css" rel="stylesheet">
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>


    <script type="text/javascript">

        function check(SeqID) {
            $.ajax({
                type: "POST",
                url: "/Claims/Details",
                data: '{SeqID: "' + SeqID + '" }',
                contentType: "application/json; charset=utf-8",
                dataType: "html",
                success: function (response) {
                    $('#dialog').html(response);
                    $('#dialog').dialog('open');
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }

        $("#dialog").dialog({
            autoOpen: false,
            modal: true,
            show: true,
            title: "Intake Claim Data",
            width: 900//,
            //buttons: {
            //    "Save": function () {
            //        $(this).dialog("close");
            //    },
            //    "Cancel": function () {
            //        $(this).dialog("close");
            //    }
            //}
        });

    </script>
}